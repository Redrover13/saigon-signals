{"version":3,"sources":["../../src/lib/auth.ts"],"sourcesContent":["/**\n * @file GCP Authentication utilities\n * @author Dulce de Saigon Team\n * @copyright 2025 Dulce de Saigon\n * @license MIT\n */\n\nimport { GoogleAuth } from \"google-auth-library\";\n\n/**\n * Creates an authenticated client for Google Cloud services\n * @param scopes - The scopes required for the client\n * @returns An authenticated Google Auth client\n */\nexport async function createAuthClient(scopes: string | string[] = []) {\n  const auth = new GoogleAuth({\n    scopes: Array.isArray(scopes) ? scopes : [scopes],\n  });\n\n  return auth.getClient();\n}\n\n/**\n * Gets the project ID from the environment or credentials\n * @returns The Google Cloud project ID\n */\nexport async function getProjectId(): Promise<string> {\n  const auth = new GoogleAuth();\n  return auth.getProjectId();\n}\n\n/**\n * Gets Application Default Credentials token\n * @param scopes - The scopes required for the token\n * @returns The access token\n */\nexport async function getAccessToken(\n  scopes: string | string[] = []\n): Promise<string> {\n  const auth = new GoogleAuth({\n    scopes: Array.isArray(scopes) ? scopes : [scopes],\n  });\n\n  const client = await auth.getClient();\n  const token = await client.getAccessToken();\n\n  if (!token.token) {\n    throw new Error(\"Failed to retrieve access token\");\n  }\n\n  return token.token;\n}\n"],"names":["GoogleAuth","createAuthClient","scopes","auth","Array","isArray","getClient","getProjectId","getAccessToken","client","token","Error"],"mappings":"AAAA;;;;;CAKC,GAED,SAASA,UAAU,QAAQ,sBAAsB;AAEjD;;;;CAIC,GACD,OAAO,eAAeC,iBAAiBC,SAA4B,EAAE;IACnE,MAAMC,OAAO,IAAIH,WAAW;QAC1BE,QAAQE,MAAMC,OAAO,CAACH,UAAUA,SAAS;YAACA;SAAO;IACnD;IAEA,OAAOC,KAAKG,SAAS;AACvB;AAEA;;;CAGC,GACD,OAAO,eAAeC;IACpB,MAAMJ,OAAO,IAAIH;IACjB,OAAOG,KAAKI,YAAY;AAC1B;AAEA;;;;CAIC,GACD,OAAO,eAAeC,eACpBN,SAA4B,EAAE;IAE9B,MAAMC,OAAO,IAAIH,WAAW;QAC1BE,QAAQE,MAAMC,OAAO,CAACH,UAAUA,SAAS;YAACA;SAAO;IACnD;IAEA,MAAMO,SAAS,MAAMN,KAAKG,SAAS;IACnC,MAAMI,QAAQ,MAAMD,OAAOD,cAAc;IAEzC,IAAI,CAACE,MAAMA,KAAK,EAAE;QAChB,MAAM,IAAIC,MAAM;IAClB;IAEA,OAAOD,MAAMA,KAAK;AACpB"}